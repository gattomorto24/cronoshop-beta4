<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CronoAI - Il Tuo Assistente di Shopping</title>
    <meta name="description" content="Chatta con CronoAI per trovare le migliori offerte, ricevere consigli e semplificare il tuo shopping.">
    <meta name="author" content="Cronoshop Team">
    <link rel="canonical" href="https://www.cronoshop.eu/cronoai.html">
    <link rel="icon" type="image/png" href="assets/cronoshop-logo.png">
    <link rel="apple-touch-icon" href="assets/cronoshop-logo.png">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="themes.js" defer></script>

    <style>
        /* --- [1] IMPOSTAZIONI GLOBALI E VARIABILI --- */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        :root {
            --bg-main: #121212; --bg-glass: rgba(28, 28, 30, 0.75); --bg-interactive: rgba(44, 44, 46, 0.8);
            --border-glass: rgba(255, 255, 255, 0.15); --text-primary: #f5f5f7; --text-secondary: #a0a0a5;
            --accent-primary: #0A84FF; --overlay-bg: rgba(0, 0, 0, 0.6); --radius-main: 24px; --radius-sub: 16px;
            --transition-smooth: 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); --font-main: 'Inter', -apple-system, sans-serif;
            --font-size-base: 16px;
        }
        body.light-mode {
            --bg-main: #f0f2f5; --bg-glass: rgba(255, 255, 255, 0.7); --bg-interactive: rgba(229, 229, 234, 0.8);
            --border-glass: rgba(0, 0, 0, 0.1); --text-primary: #1d1d1f; --text-secondary: #6e6e73; --accent-primary: #007AFF;
            --overlay-bg: rgba(0, 0, 0, 0.4);
        }

        /* --- [2] RESET E STILI BASE --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-main); font-size: var(--font-size-base); background: var(--bg-main);
            color: var(--text-primary); transition: background 0.3s, color 0.3s; padding: 20px;
            min-height: 100vh; display: flex; flex-direction: column;
        }
        .page-wrapper { padding-top: 80px; flex-grow: 1; display: flex; flex-direction: column; }
        .glass { background: var(--bg-glass); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--border-glass); border-radius: var(--radius-main); transition: background 0.3s, border 0.3s; }
        body.glass-disabled .glass { backdrop-filter: none; -webkit-backdrop-filter: none; }
        a { color: var(--accent-primary); text-decoration: none; font-weight: 500; }
        
        /* --- [3] HEADER, SEARCH & SIDEBARS (STANDARD) --- */
        .main-header { position: fixed; top: 20px; left: 20px; right: 20px; z-index: 1000; display: flex; align-items: center; gap: 20px; padding: 0 20px; height: 70px; }
        .header-btn { background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 28px; display: flex; align-items: center; padding: 8px; border-radius: 50%; transition: all 0.2s; z-index: 1002; }
        .header-btn:hover { background-color: var(--bg-interactive); color: var(--text-primary); }
        .search-container-wrapper { flex-grow: 1; display: flex; justify-content: center; }
        .search-container { display: flex; align-items: center; gap: 15px; padding: 0 20px; width: 100%; max-width: 80px; height: 50px; border-radius: 25px; cursor: pointer; transition: all var(--transition-smooth); overflow: hidden; }
        .search-container.active { max-width: 500px; cursor: text; }
        .search-container i { font-size: 20px; color: var(--text-secondary); transition: color 0.3s; }
        .search-container.active i { color: var(--accent-primary); }
        .search-container input { background: none; border: none; outline: none; color: var(--text-primary); font-size: 16px; width: 100%; opacity: 0; transform: translateX(-20px); transition: opacity 0.3s ease, transform 0.3s ease; }
        .search-container.active input { opacity: 1; transform: translateX(0); }
        .search-container input::placeholder { color: var(--text-secondary); }
        .sidebar { position: fixed; top: 0; height: 100%; width: 300px; z-index: 2000; padding: 20px; transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .left-sidebar { left: 0; transform: translateX(-105%); }
        .right-sidebar { right: 0; transform: translateX(105%); }
        .sidebar.active { transform: translateX(0); }
        .sidebar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding: 10px 0; }
        .sidebar-header h3 { font-size: 24px; font-weight: 700; }
        .close-btn { background: rgba(255, 255, 255, 0.1); color: var(--text-primary); border: none; width: 36px; height: 36px; border-radius: 50%; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .close-btn:hover { background-color: rgba(255, 255, 255, 0.2); transform: rotate(90deg); }
        .sidebar-nav ul { list-style: none; display: flex; flex-direction: column; gap: 8px; }
        .sidebar-nav a, .setting-item { display: flex; align-items: center; gap: 15px; padding: 12px 15px; border-radius: 12px; font-size: 16px; font-weight: 500; color: var(--text-secondary); text-decoration: none; transition: all 0.2s; }
        .sidebar-nav a:hover, .setting-item:hover { background-color: var(--accent-primary); color: white; transform: translateX(5px); }
        .sidebar-nav a i { font-size: 22px; min-width: 25px; text-align: center; }
        .setting-item { justify-content: space-between; cursor: pointer; }
        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 30px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; inset: 0; background-color: var(--bg-interactive); border-radius: 34px; transition: .4s; }
        .slider:before { position: absolute; content: ""; height: 22px; width: 22px; left: 4px; bottom: 4px; background-color: white; border-radius: 50%; transition: .4s; }
        input:checked + .slider { background-color: var(--accent-primary); }
        input:checked + .slider:before { transform: translateX(20px); }
        .overlay { position: fixed; inset: 0; background: var(--overlay-bg); z-index: 1999; opacity: 0; visibility: hidden; transition: opacity 0.4s ease, visibility 0.4s ease; }
        .overlay.active { opacity: 1; visibility: visible; }
        
        /* --- [4] DESIGN PAGINA CHATBOT --- */
        .chat-container {
            max-width: 900px;
            width: 100%;
            margin: 0 auto;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        #chat-messages {
            flex-grow: 1;
            padding: 1.5rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .message {
            display: flex;
            gap: 10px;
            max-width: 80%;
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        .bot .avatar { background: var(--accent-primary); color: white; }
        .user .avatar { background: var(--bg-interactive); }
        
        .bubble {
            padding: 1rem 1.5rem;
            border-radius: var(--radius-main);
            line-height: 1.6;
        }
        .bot .bubble { background: var(--bg-interactive); border-top-left-radius: 8px; }
        .user .bubble { background: var(--accent-primary); color: white; border-top-right-radius: 8px; }
        
        .user { align-self: flex-end; flex-direction: row-reverse; }

        .typing-indicator { align-items: center; }
        .typing-indicator .bubble { display: flex; gap: 5px; padding: 1.2rem 1.5rem; }
        .typing-indicator .dot { width: 8px; height: 8px; background-color: var(--text-secondary); border-radius: 50%; animation: typing 1.4s infinite ease-in-out; }
        .typing-indicator .dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator .dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); } }

        .chat-input-area { padding: 1rem; }
        #chat-form { display: flex; gap: 10px; align-items: center; padding: 0.8rem; border-radius: var(--radius-main); }
        #chat-input {
            flex-grow: 1; background: none; border: none; outline: none; color: var(--text-primary);
            font-size: 1rem; font-family: inherit; height: 48px; padding: 0 1rem;
        }
        #send-btn {
            width: 48px; height: 48px; border-radius: 50%; border: none;
            background: var(--accent-primary); color: white; font-size: 1.5rem;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            transition: transform 0.2s, background-color 0.2s;
        }
        #send-btn:hover { transform: scale(1.1); }
        #send-btn:disabled { background: var(--bg-interactive); cursor: not-allowed; }

        /* Mobile Optimization */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .page-wrapper { padding-top: 70px; }
            .main-header { top: 10px; left: 10px; right: 10px; }
            .message { max-width: 90%; }
        }

    </style>
</head>
<body class="dark-mode">

    <header class="main-header glass" id="mainHeader"></header>
    <aside class="sidebar left-sidebar glass" id="leftSidebar"></aside>
    <aside class="sidebar right-sidebar glass" id="rightSidebar"></aside>
    <div class="overlay" id="overlay"></div>

    <div class="page-wrapper">
        <main class="chat-container glass">
            <div id="chat-messages">
                </div>
            <div class="chat-input-area">
                <form id="chat-form" class="glass">
                    <input type="text" id="chat-input" placeholder="Chiedi qualcosa a CronoAI..." autocomplete="off">
                    <button type="submit" id="send-btn" aria-label="Invia messaggio">
                        <i class="ph-bold ph-paper-plane-tilt"></i>
                    </button>
                </form>
            </div>
        </main>
    </div>

    <script src="themes.js" defer></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- LOGICA UI STANDARD (MENU, RICERCA, OVERLAY) ---
            const leftSidebar = document.getElementById('leftSidebar');
            const rightSidebar = document.getElementById('rightSidebar');
            const overlay = document.getElementById('overlay');
            const mainHeader = document.getElementById('mainHeader');

            mainHeader.innerHTML = `
                <button class="header-btn" id="leftSidebarBtn" aria-label="Apri menu"><i class="ph-bold ph-list"></i></button>
                <div class="search-container-wrapper"><a href="index.html" style="text-decoration:none; color: var(--text-primary); font-weight: 600; font-size: 1.2rem;">CronoAI</a></div>
                <button class="header-btn" id="rightSidebarBtn" aria-label="Apri impostazioni"><i class="ph-bold ph-gear"></i></button>`;
            
            leftSidebar.innerHTML = `
                <div class="sidebar-header"><h3>Menu</h3><button class="close-btn" id="closeLeftSidebarBtn"><i class="ph-bold ph-x"></i></button></div>
                <nav class="sidebar-nav">
                     <ul>
                        <li><a href="index.html"><i class="ph ph-house"></i> Home</a></li>
                        <li><a href="account.html"><i class="ph ph-user-circle"></i> Account</a></li>
                        <li><a href="products.html"><i class="ph ph-shopping-bag"></i> Prodotti</a></li>
                        <li><a href="wishlist.html"><i class="ph ph-heart"></i> Wishlist</a></li>
                        <li><a href="cart.html"><i class="ph ph-shopping-cart"></i> Carrello</a></li>
                        <li><a href="chisiamo.html"><i class="ph ph-info"></i> Chi Siamo</a></li>
                        <li><a href="blog.html"><i class="ph ph-newspaper"></i> Blog</a></li>
                        <li><a href="stats.html"><i class="ph ph-chart-bar"></i> Statistiche</a></li>
                        <li><a href="themes.html"><i class="ph ph-palette"></i> Temi</a></li>
                        <li><a href="faq.html"><i class="ph ph-question"></i> FAQ</a></li>
                        <li><a href="privacy.html"><i class="ph ph-shield-check"></i> Privacy</a></li>
                        <li><a href="terms.html"><i class="ph ph-file-text"></i> Termini</a></li>
                    </ul>
                </nav>`;

            rightSidebar.innerHTML = `
                <div class="sidebar-header"><h3>Impostazioni</h3><button class="close-btn" id="closeRightSidebarBtn"><i class="ph-bold ph-x"></i></button></div>
                <nav class="sidebar-nav">
                    <ul>
                        <li><label class="setting-item" for="themeToggle"><span><i class="ph ph-moon"></i> Tema Scuro</span><div class="toggle-switch"><input type="checkbox" id="themeToggle" checked><span class="slider"></span></div></label></li>
                        <li><a href="#"><i class="ph ph-bell"></i> Notifiche</a></li>
                    </ul>
                </nav>`;
            
            const leftSidebarBtn = document.getElementById('leftSidebarBtn');
            const rightSidebarBtn = document.getElementById('rightSidebarBtn');
            const closeLeftSidebarBtn = document.getElementById('closeLeftSidebarBtn');
            const closeRightSidebarBtn = document.getElementById('closeRightSidebarBtn');

            const toggleSidebar = (sidebar, open) => {
                sidebar.classList.toggle('active', open);
                const anySidebarOpen = leftSidebar.classList.contains('active') || rightSidebar.classList.contains('active');
                overlay.classList.toggle('active', anySidebarOpen);
            };

            leftSidebarBtn.addEventListener('click', (e) => { e.stopPropagation(); toggleSidebar(leftSidebar, true); });
            rightSidebarBtn.addEventListener('click', (e) => { e.stopPropagation(); toggleSidebar(rightSidebar, true); });
            closeLeftSidebarBtn.addEventListener('click', () => toggleSidebar(leftSidebar, false));
            closeRightSidebarBtn.addEventListener('click', () => toggleSidebar(rightSidebar, false));
            overlay.addEventListener('click', () => { toggleSidebar(leftSidebar, false); toggleSidebar(rightSidebar, false); });
            
            // --- LOGICA SPECIFICA PAGINA CHATBOT ---
            class ChatbotManager {
                constructor() {
                    this.knowledgeBase = {
                        // Saluti e convenevoli
                        greetings: {
                            keywords: ['ciao', 'salve', 'ehi', 'buongiorno', 'buonasera', 'yo', 'saluto'],
                            answer: "Ciao! Sono CronoAI, il tuo assistente personale per lo shopping. Come posso aiutarti a trovare le migliori offerte oggi?"
                        },
                        howAreYou: {
                            keywords: ['come stai', 'tutto bene', 'come va'],
                            answer: "Funziono a pieno regime, grazie! Sono sempre carico e pronto a scovare sconti per te. Cosa cerchiamo?"
                        },
                        thankYou: {
                            keywords: ['grazie', 'ti ringrazio', 'gentile', 'grazie mille'],
                            answer: "Prego! √à un piacere essere d'aiuto. C'√® altro che posso fare per te?"
                        },
                        whoAreYou: {
                            keywords: ['chi sei', 'cosa sei', 'parlo con', 'sei un bot', 'sei una persona', 'sei reale'],
                            answer: "Sono CronoAI, un'intelligenza artificiale creata dal team di Cronoshop per guidarti nel mondo delle offerte Amazon. Non sono umano, ma sono un esperto di risparmio!"
                        },
                        // Domande su prodotti
                        genericProduct: {
                            keywords: ['prodotto', 'articolo', 'cosa', 'cerco', 'vorrei', 'consigliami', 'trovami', 'sto cercando'],
                            answer: "Certo! Per darti il consiglio migliore, potresti essere pi√π specifico? Ad esempio, che categoria di prodotto ti interessa (es. 'smartphone', 'cuffie', 'cucina'...) o hai un budget in mente?"
                        },
                        smartphone: {
                            keywords: ['smartphone', 'telefoni', 'cellulare', 'iphone', 'samsung', 'android', 'pixel', 'xiaomi', 'oppo', 'oneplus', 'realme'],
                            answer: `Gli smartphone sono il mio pane quotidiano! Per aiutarti al meglio, dimmi:
                                    <ul>
                                        <li>Qual √® il tuo <strong>budget</strong>? (es. "sotto i 300 euro")</li>
                                        <li>Qual √® l'<strong>uso principale</strong>? (es. "fare foto", "giocare", "per lavoro")</li>
                                        <li>Hai una <strong>marca</strong> preferita?</li>
                                    </ul>`
                        },
                         headphones: {
                            keywords: ['cuffie', 'cuffiette', 'auricolari', 'airpods', 'bose', 'sony', 'jbl', 'beats', 'sennheiser', 'earbuds'],
                            answer: "Subito! Un buon audio √® fondamentale. Che tipo preferisci? üéß<br><ul><li><strong>Over-ear</strong> (quelle grandi che coprono l'orecchio) per il massimo isolamento.</li><li><strong>In-ear</strong> (gli auricolari) per la portabilit√†.</li><li>Cerchi la <strong>cancellazione attiva del rumore</strong> (ANC)?</li></ul>"
                        },
                        laptop: {
                            keywords: ['pc', 'portatile', 'computer', 'notebook', 'macbook', 'laptop', 'ultrabook'],
                            answer: "Certo! Per trovare il portatile giusto, ho bisogno di sapere: per cosa lo userai principalmente?<ul><li><strong>Studio/Ufficio:</strong> Leggero e con buona autonomia.</li><li><strong>Gaming:</strong> Potente con una buona scheda video.</li><li><strong>Uso generico:</strong> (Email, web, film).</li></ul>Hai preferenze tra Windows, macOS o magari un Chromebook?"
                        },
                        tv: {
                            keywords: ['tv', 'televisione', 'televisore', 'smart tv', 'qled', 'oled', '4k', '8k'],
                            answer: "Ottima idea una nuova TV! Quali sono le tue priorit√†?<ul><li><strong>Dimensione:</strong> Quanti pollici? (es. 55 pollici)</li><li><strong>Tecnologia:</strong> OLED per neri perfetti e contrasto infinito, o QLED/Mini-LED per la massima luminosit√†?</li><li><strong>Budget:</strong> Hai una fascia di prezzo in mente?</li></ul>"
                        },
                        // Consigli per regali
                        gift: {
                            keywords: ['regalo', 'regalare', 'idea regalo', 'pensierino', 'compleanno', 'natale', 'anniversario', 'laurea'],
                            answer: "Adoro fare regali! Per chi √®? Dammi qualche dettaglio e ti trover√≤ l'idea perfetta. Ad esempio: 'regalo per pap√† 60 anni, ama il giardinaggio, budget 50 euro'."
                        },
                        // Funzionalit√† del sito
                        howItWorks: {
                            keywords: ['come funziona', 'cos\'√® cronoshop', 'cosa fate', 'scopo'],
                            answer: "√à molto semplice! Noi di Cronoshop troviamo e selezioniamo le migliori offerte su Amazon ogni giorno. Tu le vedi sul nostro sito e, se un prodotto ti interessa, cliccando verrai reindirizzato su Amazon per completare l'acquisto in sicurezza. Noi riceviamo una piccola commissione da Amazon, senza alcun costo aggiuntivo per te. √à un sistema vantaggioso per tutti!"
                        },
                        isFree: {
                            keywords: ['gratis', 'costa', 'pagare', 'abbonamento', 'prezzo', 'costi'],
                            answer: "Assolutamente s√¨, il nostro servizio √® e sar√† sempre <strong>100% gratuito</strong> per te. Il nostro guadagno deriva dalle commissioni di affiliazione pagate da Amazon, non dagli utenti."
                        },
                        // Fallback e battute
                        joke: {
                            keywords: ['barzelletta', 'divertente', 'raccontami', 'ridere', 'spiritoso'],
                            answer: "Certo! Sai perch√© i computer non hanno mai caldo? Perch√© hanno sempre un sacco di fan! üòâ"
                        },
                        default: {
                            keywords: [],
                            answer: "Non sono sicuro di aver capito. Prova a chiedermi qualcosa di specifico, come 'Migliori cuffie con cancellazione del rumore' o 'Consigliami un regalo per mia madre'."
                        }
                    };
                    
                    this.chatMessages = document.getElementById('chat-messages');
                    this.chatForm = document.getElementById('chat-form');
                    this.chatInput = document.getElementById('chat-input');
                    this.sendBtn = document.getElementById('send-btn');

                    this.init();
                }

                init() {
                    this.chatForm.addEventListener('submit', (e) => this.handleUserMessage(e));
                    this.addMessage("Ciao! Sono CronoAI, il tuo assistente personale per lo shopping. Chiedimi pure un consiglio, un'idea regalo o un'offerta specifica!", 'bot');
                }

                handleUserMessage(event) {
                    event.preventDefault();
                    const userInput = this.chatInput.value.trim();
                    if (!userInput) return;

                    this.addMessage(userInput, 'user');
                    this.chatInput.value = '';
                    this.thinkAndRespond(userInput);
                }

                addMessage(text, sender) {
                    const messageElement = document.createElement('div');
                    messageElement.className = `message ${sender}`;
                    messageElement.innerHTML = `
                        <div class="avatar">
                            <i class="ph-bold ${sender === 'bot' ? 'ph-robot' : 'ph-user'}"></i>
                        </div>
                        <div class="bubble">${text.replace(/\n/g, '<br>')}</div>
                    `;
                    this.chatMessages.appendChild(messageElement);
                    this.scrollToBottom();
                }

                showTypingIndicator() {
                    const indicator = document.createElement('div');
                    indicator.id = 'typing-indicator';
                    indicator.className = 'message bot typing-indicator';
                    indicator.innerHTML = `
                        <div class="avatar"><i class="ph-bold ph-robot"></i></div>
                        <div class="bubble">
                            <div class="dot"></div><div class="dot"></div><div class="dot"></div>
                        </div>
                    `;
                    this.chatMessages.appendChild(indicator);
                    this.scrollToBottom();
                }
                
                hideTypingIndicator() {
                    const indicator = document.getElementById('typing-indicator');
                    if (indicator) indicator.remove();
                }

                async thinkAndRespond(userInput) {
                    this.sendBtn.disabled = true;
                    this.showTypingIndicator();

                    await new Promise(resolve => setTimeout(resolve, 1500 + Math.random() * 1000));

                    const response = this.findResponse(userInput);
                    this.hideTypingIndicator();
                    this.addMessage(response, 'bot');
                    this.sendBtn.disabled = false;
                }

                findResponse(userInput) {
                    const lowerInput = userInput.toLowerCase();
                    let bestMatch = { score: 0, answer: this.knowledgeBase.default.answer };

                    for (const key in this.knowledgeBase) {
                        const entry = this.knowledgeBase[key];
                        if (!entry.keywords) continue;

                        let currentScore = 0;
                        entry.keywords.forEach(keyword => {
                            // Diamo un peso maggiore alle parole chiave esatte
                            const regex = new RegExp(`\\b${keyword}\\b`);
                            if (regex.test(lowerInput)) {
                                currentScore += 2;
                            } else if (lowerInput.includes(keyword)) {
                                currentScore += 1;
                            }
                        });

                        if (currentScore > bestMatch.score) {
                            bestMatch = { score: currentScore, answer: entry.answer };
                        }
                    }
                    return bestMatch.answer;
                }
                
                scrollToBottom() {
                    this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
                }
            }

            new ChatbotManager();
        });
    </script>
</body>
</html>
